# iPhone真机测试指南 - 三位一体语音系统

## 测试前准备

### 1. 在Xcode中添加音频文件（1分钟）
音频文件已复制到项目，需要在Xcode中添加引用：

1. 双击打开 `AIRunningCoach.xcodeproj`
2. 右键点击左侧 `AIRunningCoach` 文件夹 → `Add Files to "AIRunningCoach"...`
3. 选择 `voice` 文件夹
4. ✅ 勾选 `Copy items if needed`
5. ✅ 选择 `Create groups`
6. ✅ 勾选 Target: `AIRunningCoach`
7. 点击 `Add`

### 2. 连接iPhone并运行
1. 用数据线连接iPhone到Mac
2. 在Xcode顶部工具栏选择你的iPhone设备
3. 按 `Cmd+R` 或点击运行按钮 ▶️
4. 首次运行需要在iPhone上：设置 → 通用 → VPN与设备管理 → 信任开发者

---

## 测试场景1：新手3公里完整流程

### 预期语音触发点（10条）

| 距离 | 语音类型 | 预期内容 | 性别 |
|------|---------|---------|------|
| 开始 | 跑前_01 | "我们轻轻开始，跟着自己的节奏就好..." | 女声 |
| 0.5km | 新手跑中_01 | "身体热起来啦，鼻子吸气嘴巴呼气..." | 男声 |
| 0.9km | 成就提醒 | "再跑100米就解锁1公里成就了！" | TTS |
| 1.0km | 新手跑中_02 | "1公里达成！80%的人都没跑过..." | 男声 |
| 1.5km | 新手跑中_03 | "已经过半啦，肩膀耸耸肩..." | 男声 |
| 2.0km | 新手跑中_04 | "2公里了！新手毕业线就在眼前..." | 男声 |
| 2.2km | 新手跑中_05 | "累了就走30秒，这不是放弃..." | 男声 |
| 2.5km | 新手跑中_06 | "最后500米！你已经跑了83%..." | 男声 |
| 2.7km | 成就提醒 | "还剩300米就能解锁3公里成就..." | TTS |
| 2.8km | 新手跑中_07 | "最后200米，感受心跳..." | 男声 |
| 3.0km | 新手跑中_08 | "搞定！3公里达成，你太棒了！" | 男声 |
| 3.0km | 跑后_01 | "3公里完成啦，慢慢走一会儿..." | 女声 |
| +3秒 | 跑后_02 | "点击结束，解锁你的成就徽章吧！" | 女声 |

### 测试步骤：
1. ✅ 点击"开始跑步" → 听到女声开场
2. ✅ 跑到0.5km → 听到男声第一条鼓励
3. ✅ 跑到0.9km → 听到TTS成就提醒
4. ✅ 跑到1km → 听到男声"1公里达成"
5. ✅ 继续跑，每个里程碑都会触发对应语音
6. ✅ 到3km → 听到男声"搞定" → 女声"完成"
7. ✅ 点击"结束" → 进入总结页
8. ✅ 点击成就徽章 → 听到女声成就语音

---

## 测试场景2：减肥燃脂完整流程

### 预期语音触发点（8条）

| 距离 | 语音类型 | 预期内容 | 性别 |
|------|---------|---------|------|
| 开始 | 跑前_01 | "我们轻轻开始..." | 女声 |
| 0.5km | 减肥跑中_01 | "燃脂模式启动，保持轻松交谈..." | 男声 |
| 1.0km | 减肥跑中_02 | "1公里+100大卡！相当于1个小蛋糕..." | 男声 |
| 1.5km | 减肥跑中_03 | "心率超棒，正处黄金燃脂区..." | 男声 |
| 2.0km | 减肥跑中_04 | "2公里达成！散步1小时的量..." | 男声 |
| 2.5km | 减肥跑中_05 | "最后500米，冲刺燃脂..." | 男声 |
| 3.0km | 减肥跑中_06 | "燃脂跑完成！今天的热量缺口..." | 男声 |
| 3.0km | 跑后_01 | "3公里完成啦..." | 女声 |
| +3秒 | 跑后_02 | "点击结束，解锁成就..." | 女声 |

### 测试步骤：
1. ✅ 在主页选择"减肥燃脂"目标
2. ✅ 点击"开始跑步"
3. ✅ 按上表验证每个语音触发点
4. ✅ 完成后检查成就解锁

---

## 测试场景3：成就系统联动

### 可能解锁的成就（首次跑步）

| 成就名称 | 解锁条件 | 语音文件 |
|---------|---------|---------|
| 初露锋芒 | 首次完成3公里 | 新手成就_01 |
| 节奏大师 | 配速稳定 | 新手成就_02 |
| 脂肪杀手 | 单次燃脂500大卡 | 减肥成就_01 |

### 测试步骤：
1. ✅ 完成3km跑步
2. ✅ 点击"结束"进入总结页
3. ✅ 查看成就横幅（紫色背景）
4. ✅ 点击成就徽章 → 听到女声庆祝语音
5. ✅ 验证语音与成就匹配

---

## 测试场景4：异常情况

### 提前结束
1. ✅ 开始跑步后，跑不到3km
2. ✅ 长按"结束"按钮
3. ✅ 应该听到女声"想提前结束完全可以..."（应急_02）

### 麦克风开关
1. ✅ 跑步界面右上角点击麦克风按钮
2. ✅ 图标变灰，语音停止
3. ✅ 再次点击，语音恢复

---

## 调试技巧

### 查看日志输出
在Xcode底部控制台查看：
```
🎙️ 播放开始语音: 跑前_01
🎙️ 播放距离语音: 新手跑中_01 at 0.5km
✅ 音频播放完成
```

### 常见问题

**Q: 听不到语音？**
- 检查iPhone音量
- 检查麦克风按钮是否启用（绿色）
- 查看Xcode控制台是否有 `❌ 找不到音频文件` 错误

**Q: 语音重叠？**
- AudioPlayerManager有队列管理，理论上不会重叠
- 如果出现，查看控制台日志

**Q: 某个距离点没触发？**
- GPS精度问题，可能跳过某个点
- 系统有50米容差，应该能覆盖

**Q: 成就没解锁？**
- 首次跑步一定会解锁"初露锋芒"
- 其他成就根据条件判断

---

## 三位一体联动验证 ✅

测试完成后，验证三个系统是否联动：

1. **训练计划 →** 选择目标影响语音内容
   - 新手3公里：8条男声跑中语音
   - 减肥燃脂：6条男声跑中语音

2. **语音系统 →** 实时鼓励和里程碑提醒
   - 女声：开场、完成、成就、应急
   - 男声：跑中里程碑
   - TTS：成就90%提醒

3. **成就系统 →** 解锁触发庆祝语音
   - 跑步中：90%进度TTS提醒
   - 总结页：点击徽章播放成就语音

---

## 预期完整体验

**用户旅程：**
```
选择"新手3公里"计划
    ↓
点击"开始跑步"（女声：我们轻轻开始...）
    ↓
GPS定位 → 开始跑步
    ↓
0.5km（男声：身体热起来啦...）
    ↓
0.9km（TTS：再跑100米解锁成就...）
    ↓
1km（男声：1公里达成...）
    ↓
... 持续鼓励 ...
    ↓
2.7km（TTS：还剩300米解锁成就...）
    ↓
3km（男声：搞定！）→（女声：完成啦）→（女声：解锁成就）
    ↓
点击"结束" → 总结页
    ↓
看到成就徽章 → 点击 → 女声庆祝
    ↓
分享成就 🎉
```

---

**开始测试吧！祝你跑步愉快！🏃‍♂️**
