### **AI跑步教练 PRD (产品需求文档)**

**版本:** 1.0
**日期:** 2026年1月21日
**项目负责人:** 周晓红

---

### **1. 项目概述 (Executive Summary)**

#### **1.1. 项目背景**

随着全民健康意识的提升和AI技术的消费级应用爆发，传统跑步应用在个性化指导和情感激励方面存在明显不足。本项目旨在利用现有成熟的LBS核心技术栈，结合生成式AI能力，打造一款面向iOS平台的“AI跑步教练”应用。它不仅是GPS轨迹记录工具，更是一位懂你、能实时指导你、激励你的私人跑步伙伴。

#### **1.2. 产品定位**

**AI Personal Coach + GPS Tracking**  
我们专注于“小而美”的效率付费，不做“大而全”的运动社区。通过AI增强，为用户提供极致个性化、沉浸式的跑步体验，切入垂直细分市场，避开通用AI红海。

#### **1.3. 商业目标**

* **短期 (3-6个月):** 快速开发并上线1.0版本，验证核心玩法和市场接受度，获取首批高价值付费用户。
* **中期 (1年内):** 基于用户数据和反馈，深度优化AI教练算法，丰富训练计划和社交玩法，提升用户留存率和付费转化率。
* **长期 (2-3年):** 成为跑步细分领域的头部AI应用，探索更多商业变现模式，实现可观的订阅收入。

#### **1.4. 成功公式 (The Winning Formula)**

遵循“2026独立开发者成功公式”：  
**垂直细分市场 (跑步) + AI增强 (个性化教练) + 订阅模式 (商业变现) + iOS优先 (高价值用户) = 高成功率**

---

### **2. 目标用户 (Target Audience)**

* **核心用户:**
  * **初中级跑者:** 有跑步习惯，希望科学提升成绩、避免受伤，但缺乏专业指导。
  * **减肥/健身人群:** 将跑步作为主要锻炼方式，需要持续的激励和科学的计划来达成目标。
* **次要用户:**
  * **资深跑者:** 寻求新的跑步体验，利用AI进行数据分析和状态调整。

---

### **3. 功能需求 (Functional Requirements)**

#### **3.1. 核心功能 (MVP - 最小可行产品)**

| 模块             | 功能点             | 详细描述                                                               | 优先级    | 备注                                        |
|:-------------- |:--------------- |:------------------------------------------------------------------ |:------ |:----------------------------------------- |
| **GPS轨迹与数据记录** | 1. 实时GPS定位与轨迹绘制 | 在苹果地图 (MapKit) 上实时显示用户位置，并绘制跑步轨迹。                                  | **P0** | 复用`LocationManager`，利用苹果MapKit免费、全球可用的优势。 |
|                | 2. 核心数据统计       | 实时计算并显示：配速 (Pace)、距离 (Distance)、时长、消耗卡路里。                          | **P0** |                                           |
| **AI个性化训练**    | 3. 动态训练计划生成     | 用户设定目标（如5km、10km、减肥），AI根据用户的历史数据（配速、心率、跑量）生成个性化的周/月训练计划。           | **P0** | AI核心，可调用OpenAI/Claude API，结合用户数据进行分析。     |
|                | 4. **AI语音实时教练** | 跑步过程中，AI通过语音实时反馈，提供指导和激励。例如：“心率过高，请适当放慢速度”、“配速稳定，保持住！”、“最后1公里，加油！” | **P0** | 复用`SpeechManager`，这是营造“感官沉浸”和“情绪解压”的关键。   |
| **成就与激励系统**    | 5. 成就体系         | 设置不同等级的成就徽章，如“首次完成5km”、“月度全勤”、“最长距离记录”等，完成可获得虚拟奖励。                 | **P1** | 复用`AchievementManager`，采用游戏化设计引导用户，提升粘性。  |
| **用户系统**       | 6. 登录与注册        | 支持Apple ID一键登录、邮箱注册。                                               | **P0** | 复用`AuthManager`，使用Supabase Auth实现，安全、高效。  |
|                | 7. 个人主页与历史记录    | 展示用户的总跑量、跑步次数、个人最佳纪录（PB）、获得的成就徽章，并提供详细的单次跑步历史数据回顾。                 | **P0** |                                           |

#### **3.2. 后续版本功能 (V1.1+)**

| 模块       | 功能点       | 详细描述                                          | 优先级    | 备注                            |
|:-------- |:--------- |:--------------------------------------------- |:------ |:----------------------------- |
| **商业化**  | 8. 付费订阅   | 推出Pro会员订阅，解锁高级AI训练计划、无限次AI教练指导、深度数据分析报告等高级功能。 | **P1** | 使用RevenueCat处理IAP，对标$9.99/mo。 |
| **社交系统** | 9. 排行榜    | 设立好友/地区排行榜，按周/月跑量、最快5km等维度排行，激发用户竞争欲。         | **P2** | 复用`LeaderboardManager`。       |
|          | 10. 跑团/频道 | 用户可创建或加入基于地理位置的“跑团”（公共频道），在特定区域内进行交流、约跑。      | **P2** | 复用`ChannelManager`，强化社交属性。    |
| **个性化**  | 11. 多语言支持 | 支持简/繁中文、英语、日语等，为全球化推广做准备。                     | **P1** |                               |

#### **3.3. 每个功能的详细描述（按课程4.3.2模板扩展）**

以下为P0核心功能的完整拆解（用户视角 + AC + 技术），其他功能类似扩展。

1. **功能名称**：实时GPS定位与轨迹绘制  
   **功能描述（用户视角）**：用户启动跑步模式后，App实时在MapKit地图上显示当前位置，并绘制绿色跑步轨迹，支持暂停/继续。  
   **验收标准（AC）**：轨迹精度<10m，无漂移；支持离线查看历史轨迹。  
   **技术实现建议**：复用`LocationManager`（CLLocationManager + MapKit），高精度模式（kCLLocationAccuracyBest）。  
   **依赖的其他功能**：用户登录（AuthManager）。  
   **优先级**：P0。

2. **功能名称**：核心数据统计  
   **功能描述（用户视角）**：跑步界面实时显示当前配速、累计距离、时长、预计卡路里，支持历史对比。  
   **验收标准（AC）**：数据更新频率1s/次，准确率>99%。  
   **技术实现建议**：基于GPS坐标计算（距离用Haversine公式，配速=时间/距离）。  
   **依赖的其他功能**：GPS定位。  
   **优先级**：P0。

3. **功能名称**：动态训练计划生成  
   **功能描述（用户视角）**：输入目标后，AI输出周计划（如“周一：间歇跑4km”），可视化日历展示。  
   **验收标准（AC）**：计划个性化（基于历史PB），支持编辑。  
   **技术实现建议**：OpenAI API prompt："生成跑步计划，目标{goal}，用户历史{data}"，存JSON。  
   **依赖的其他功能**：历史记录。  
   **优先级**：P0。

4. **功能名称**：AI语音实时教练  
   **功能描述（用户视角）**：跑步中AI自动语音播报，如“配速提升到5:30/km，很好！”或“心率165，建议慢跑恢复”。  
   **验收标准（AC）**：语音延迟<2s，支持AirPods；用户可自定义激励风格（严格/温柔）。  
   **技术实现建议**：`SpeechManager` + OpenAI API（prompt: "作为跑步教练，根据{pace,hr,distance}给出激励反馈"）。  
   **依赖的其他功能**：GPS数据记录。  
   **优先级**：P0。

5. **功能名称**：成就体系  
   **功能描述（用户视角）**：跑步达标自动解锁徽章，主页展示收藏墙。  
   **验收标准（AC）**：10+成就类型，触发即时通知。  
   **技术实现建议**：`AchievementManager`，条件检查（如distance > 5km）。  
   **依赖的其他功能**：数据统计。  
   **优先级**：P1。

（后续功能扩展类似，保持一致性。）

---

### **4. 非功能性需求 (Non-functional Requirements)**

| 类别       | 需求描述                                                   |
|:-------- |:------------------------------------------------------ |
| **平台**   | iOS 16+。                                               |
| **性能**   | GPS定位准确，轨迹无漂移；数据计算实时，无明显延迟；应用冷启动时间<2秒。                 |
| **用户体验** | 界面设计简洁、易于操作，核心跑步功能一键可达。                                |
| **兼容性**  | 兼容主流iPhone型号，并对Apple Watch有初步适配（可显示核心数据）。              |
| **数据**   | 用户数据本地优先存储（本地优先架构），并与云端（Supabase）安全同步，保证无网状态下也可查看历史记录。 |

---

### **5. 技术架构与选型 (The Efficiency Stack)**

* **前端 (Frontend):** SwiftUI + iOS 16+  
  * **优势:** 苹果原生，性能卓越，与系统深度集成，开发效率高。
* **后端 (Backend):** Supabase (Postgres + PostGIS)  
  * **优势:** 提供Auth、Realtime、数据库API，极大简化后端开发。PostGIS原生支持地理空间数据，完美支撑LBS功能。
* **AI服务 (AI Services):** OpenAI API / Claude API  
  * **优势:** 强大的自然语言处理和分析能力，用于生成训练计划和实时语音指导。
* **订阅服务 (Subscription):** RevenueCat  
  * **优势:** 封装StoreKit 2，极大简化iOS内购和订阅管理流程。
* **技术复用:**  
  * **技术复用率高达95%**，直接沿用《地球新主》项目中已验证的核心模块，如`ExplorationManager` (GPS)、`SpeechManager` (语音)、`AchievementManager` (成就)等。

---

### **6. 商业变现 (Monetization)**

* **核心模式:** **订阅制 (Subscription)**  
  * **免费版:** 提供基础的GPS记录、单次跑步数据分析、少量成就。  
  * **Pro版 ($9.99/月):**  
    * 无限次AI个性化训练计划生成。  
    * 完整的AI语音实时教练功能。  
    * 深度跑步数据洞察报告。  
    * 解锁所有高级成就和排行榜。
* **辅助模式:** **一次性内购 (In-App Purchase)**  
  * 可提供由知名教练设计的特定训练课程包（如“21天马拉松入门”）。

---

### **7. 开发与发布**

* **开发周期:** **4-6周** (基于高技术复用率和AI辅助开发)  
* **发布平台:** Apple App Store  
* **开发工具:** Claude Code (代码生成), Figma (设计), TelemetryDeck (隐私分析)

---

### **8. 成功指标 (KPIs)**

* **用户增长:** 日/月活跃用户 (DAU/MAU)。  
* **用户留存:** 次日留存率、7日留存率、30日留存率。  
* **付费转化:** 免费用户到Pro版的转化率、订阅续费率。  
* **核心功能使用率:** 每周使用AI教练功能的用户占比。

---

### **9. 数据模型概要（基于Supabase课程经验）**

使用Supabase Postgres + PostGIS，支持LBS查询。

```sql
-- 用户表
users (id: uuid PRIMARY KEY, email: text, apple_id: text, total_distance: float, created_at: timestamp)

-- 跑步记录表 (核心)
runs (id: uuid PK, user_id: uuid FK, start_time: timestamp, end_time: timestamp, distance: float, pace: float, calories: float, geometry: geography(linestring, 4326))  -- PostGIS轨迹

-- 训练计划表
training_plans (id: uuid PK, user_id: uuid FK, goal: text, plan_json: jsonb, generated_at: timestamp)  -- AI生成的计划存JSON

-- 成就表
achievements (id: uuid PK, user_id: uuid FK, type: text, unlocked_at: timestamp)
```

**查询示例**：`SELECT * FROM runs WHERE ST_DWithin(geometry, ST_MakePoint(lon, lat)::geography, 1000)`（附近1km跑步记录）。

---

### **10. 技术架构图（文字描述）**

```
[用户 iPhone] 
  ↕ (SwiftUI UI)
[LocationManager + SpeechManager + MapKit]  ← GPS/语音/地图
  ↕ (Supabase Realtime)
[Supabase Backend]
  - Auth (登录)
  - Postgres/PostGIS (数据/轨迹)
  - Realtime (同步)
  ↕ API Calls
[AI Services: OpenAI/Claude] ← 训练计划/语音prompt
[RevenueCat] ← IAP订阅
```

**核心流程**：用户跑步 → GPS数据本地缓存 → 云同步 → AI分析 → 语音反馈。

---

### **11. 里程碑计划（Gantt式）**

| 里程碑           | 内容              | 预计时间 | 交付物          |
| ------------- | --------------- | ---- | ------------ |
| **M1: 基础搭建**  | 用户登录 + GPS轨迹    | 周1   | 可跑步记录Demo    |
| **M2: AI核心**  | 训练计划 + 语音教练     | 周2-3 | MVP完整跑步体验    |
| **M3: 激励+订阅** | 成就 + RevenueCat | 周4   | TestFlight内测 |
| **M4: 发布**    | 优化 + 上架         | 周5-6 | App Store上线  |

---

**助教结语**：完美！这份1.0版PRD已“一键开发就绪”，直接复制到Claude code生成SwiftUI代码。复用《地球新主》仓库，起步超快。加油，上线指日可待！🚀
