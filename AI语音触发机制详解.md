# AI 语音触发机制详解

## 触发类型说明

| 触发类型 | 说明 | 示例 |
|---------|------|------|
| **distance** | 距离触发 | 跑到 0.5km 时播报 |
| **calories** | 热量触发 | 燃烧 100 大卡时播报 |
| **heartRate** | 心率触发 | 心率超过 160 BPM 时播报 |
| **time** | 时长触发 | 跑步 15 分钟时播报 |
| **state** | 状态触发 | 开始(0)、行走(1)、完成(2) |
| **fatigue** | 疲劳触发 | 持续时间 > 20分钟时判定为疲劳 |
| **pace** | 配速触发 | 配速变化时 |
| **heartRateZone** | 心率区间 | 进入最佳燃脂区间时 |

---

## 新手 3 公里模式（30 条）

### 🏃 开场与热身阶段（0-0.5km）

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 1 | beginner_01_start | 距离 = 0km | 刚按下开始按钮 | "我们轻轻开始，像饭后散步一样。今天的目标很简单：完成比完美更重要。" |
| 2 | beginner_02_body_awareness | 距离 ≥ 0.1km | 跑了约 100 米 | "注意感受脚掌落地再弹起的感觉，像在弹簧床上轻轻跳。" |
| 3 | beginner_03_warmup | 距离 ≥ 0.2km | 跑了约 200 米 | "前五百米是用来让身体'打招呼'的，不用着急。" |
| 4 | beginner_04_500m | 距离 ≥ 0.5km | 完成第一个 500 米 | "五百米了！身体开始热起来了。注意呼吸，尝试'鼻子吸气，嘴巴呼气'。" |

### 💪 建立节奏阶段（0.5-1.5km）

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 5 | beginner_05_rhythm | 距离 ≥ 0.7km | 跑了 700 米 | "很好！找到节奏了吗？就像听一首喜欢的歌，让身体跟着节奏走。" |
| 6 | beginner_06_1km | 距离 ≥ 1.0km | **第一个里程碑** | "一公里！第一个里程碑。你知道吗，百分之八十的人从没跑过这么远。" |
| 7 | beginner_07_walk_ok | 心率 ≥ 160 | 心率过高时 | "如果感觉呼吸急促，很正常。我们走三十秒调整一下，这很聪明。" |
| 8 | beginner_08_keep_moving | 状态 = 行走中 | 用户开始走路时 | "走的时候也别停，保持脚步移动。想象在机场快步赶飞机。" |
| 9 | beginner_09_1_5km | 距离 ≥ 1.5km | **过半里程碑** | "一点五公里，已经过半了！剩下的路都是下坡心理。" |

### 😌 放松调整阶段（1.5-2.0km）

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 10 | beginner_10_relax | 距离 ≥ 1.6km | 中段放松提醒 | "注意肩膀是否紧绷？耸耸肩，让紧张像水流走。" |
| 11 | beginner_11_2km | 距离 ≥ 2.0km | **两公里里程碑** | "两公里！新手毕业的门槛就在眼前。" |

### 🔥 克服疲劳阶段（2.0-2.5km）

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 12 | beginner_12_reframe_fatigue | 疲劳 = 高 | 跑了 20+ 分钟，开始疲劳 | "感到累了？这是身体在说'我正在变强'。把累重新定义为进步信号。" |
| 13 | beginner_13_game | 疲劳 = 高 | 疲劳时游戏化激励 | "我们来玩个游戏：找到前面第三棵树，跑到那里就可以走十步。" |
| 14 | beginner_14_mindfulness | 疲劳 = 高 | 疲劳时正念引导 | "如果脑子里有'放弃'的念头，轻轻对它说：'我看到你了，但我选择继续'。" |

### 🏁 冲刺阶段（2.5-3.0km）

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 15 | beginner_15_2_5km | 距离 ≥ 2.5km | 最后 500 米开始 | "两点五公里！最后五百米。想象终点线有冰淇淋在等你。" |
| 16 | beginner_16_final_500m | 距离 ≥ 2.5km | 最后 500 米心理强化 | "最后五百米！你已经跑了百分之八十三，剩下的百分之十七只是锦上添花。" |
| 17 | beginner_17_choice | 距离 ≥ 2.6km | 最后 400 米 | "可以慢慢加速，像汽车平稳换挡。或者保持节奏，用你最舒服的方式。" |
| 18 | beginner_18_count_steps | 距离 ≥ 2.7km | 最后 300 米 | "最后三百米！数九十步，每步都离终点更近。" |
| 19 | beginner_19_final_100m | 距离 ≥ 2.9km | 最后 100 米 | "最后一百米！感受心脏有力的跳动，这是生命的鼓点。" |
| 20 | beginner_20_countdown | 距离 ≥ 3.0km | **到达终点** | "三…二…一…完成！三公里达成！" |

### 🎉 完成庆祝阶段（点击停止后）

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 21 | beginner_21_cooldown | 状态 = 完成 | 点击停止按钮后 | "慢慢停下，不要立刻静止。走一会儿，让心跳平稳回落。" |
| 22 | beginner_22_congrats | 状态 = 完成 | 完成后庆祝 | "恭喜！你刚刚完成了人生第一个三公里。从今天起，你就是'三公里跑者'了。" |
| 23 | beginner_23_data_recap | 状态 = 完成 | 数据总结 | "看看你的数据：三公里，[时间]。这是你能力的全新基准线。" |
| 24 | beginner_24_body_feelings | 状态 = 完成 | 身体感受引导 | "感受一下此刻的身体：肌肉的微热、呼吸的深度、心里的成就感。" |
| 25 | beginner_25_achievement | 状态 = 完成 | 成就强化 | "这个成就属于你。无论今天发生了什么，这一刻你赢了。" |

### ⚠️ 特殊情况处理

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 26 | beginner_26_heart_rate_high | 心率 ≥ 170 | 心率过高预警 | "心率有点快？我们走一分钟，专注深呼吸：吸气四秒，屏住两秒，呼气六秒。" |
| 27 | beginner_27_low_state | 状态 = 状态不佳 | 跑得很慢/中途停很多次 | "今天状态不太好？没关系。能开始就已经赢了百分之八十的人。" |
| 28 | beginner_28_early_stop | 状态 = 提前结束 | 未到 3km 就想停止 | "想提前结束？完全可以。今天跑了[距离]，已经是进步。倾听身体最重要。" |
| 29 | beginner_29_slow_pace | 配速 < 标准 | 配速比预期慢 | "配速比上次慢？看看周围，今天有风、温度高、你昨晚没睡好。环境因素很重要。" |
| 30 | beginner_30_memory_anchor | 状态 = 完成 | 最后的记忆锚定 | "记住这种感觉。下次当你不想跑时，回忆此刻的成就感。" |

---

## 减肥燃脂模式（20 条）

### 🔥 燃脂教育阶段（开始）

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 1 | fatburn_01_start | 距离 = 0km | 刚开始跑步 | "燃脂模式启动！今天的目标：让脂肪高效燃烧。保持能轻松交谈的心率。" |
| 2 | fatburn_02_education | 距离 ≥ 0.2km | 跑了 200 米 | "减肥的关键不是跑多快，而是让身体进入'燃脂区间'。我们来找这个甜蜜点。" |
| 3 | fatburn_03_metaphor | 距离 ≥ 0.3km | 跑了 300 米 | "想象你是一辆混合动力车：前十分钟烧糖，之后开始高效烧脂。我们为长远而跑。" |

### 📊 热量里程碑

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 4 | fatburn_04_100cal | 热量 ≥ 100 | **燃烧 100 大卡** | "一百大卡达成！相当于一个苹果派的热量被燃烧了。" |
| 6 | fatburn_06_200cal | 热量 ≥ 200 | **燃烧 200 大卡** | "二百大卡！这需要普通人散步五十分钟，而你用跑步二十分钟就做到了。" |
| 8 | fatburn_08_300cal | 热量 ≥ 300 | **燃烧 300 大卡** | "三百大卡里程碑！这相当于昨天晚餐多余热量的总和。" |

### 💓 心率区间管理

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 5 | fatburn_05_hr_zone | 心率区间 = 最佳 | 心率在 60-70% 最大心率 | "完美！心率正处在最佳燃脂区间，百分之六十到七十最大心率。脂肪正在高效代谢。" |
| 7 | fatburn_07_oxygen | 心率 ≥ 150 | 心率偏高提醒 | "注意呼吸，脂肪燃烧需要充足的氧气。深吸慢呼，给脂肪'通风'。" |

### 📈 效率反馈

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 9 | fatburn_09_efficiency_score | 热量 ≥ 250 | 燃脂效率高时 | "燃脂效率评分：八十五分！你正处在'黄金燃烧带'。" |
| 13 | fatburn_13_afterburn | 时长 ≥ 15 分钟 | **持续 15 分钟** | "你已经连续运动十五分钟，新陈代谢率正在提升，意味着后续二十四小时都在多燃脂。" |
| 15 | fatburn_15_weekly_progress | 热量 ≥ 1200 | 周累计进度（需要后台数据） | "本周累计燃烧：一千二百，目标二千大卡，完成度百分之六十。保持这个节奏，周目标稳稳达成。" |
| 16 | fatburn_16_fat_grams | 热量 ≥ 800 | 脂肪克数计算 | "根据你的体重和速度，预计本次跑步可减脂约二十克。这周累计已超一百克。" |

### 🎯 心理激励

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 10 | fatburn_10_poetic | 距离 ≥ 1.5km | 中段诗意激励 | "每跑一步，都在和过去的体重说再见。脚步越轻盈，身体越轻盈。" |
| 11 | fatburn_11_visualization | 疲劳 = 高 | 感到疲劳时 | "感到辛苦时，想象脂肪细胞正在缩小，像漏气的气球。" |
| 12 | fatburn_12_reframe | 疲劳 = 高 | 疲劳时认知重构 | "减肥不是惩罚，而是给自己的礼物。跑步是拆礼物的过程。" |
| 14 | fatburn_14_scale_imagine | 疲劳 = 高 | 疲劳时体重想象 | "想象体重秤的数字正在因为你此刻的努力而跳动下降。" |

### 🏆 完成总结

| # | ID | 触发条件 | 真实场景 | 语音内容 |
|---|----|---------|---------|---------|
| 17 | fatburn_17_efficiency_gain | 状态 = 行走中 | 与上次对比（需要历史数据） | "燃脂效率比上次提升百分之十五，身体正在学习更高效地燃烧脂肪。" |
| 18 | fatburn_18_continuing_burn | 状态 = 完成 | 完成后第一条 | "跑步结束！但燃脂还在继续。未来二十四小时，你的代谢率都比平时高。" |
| 19 | fatburn_19_calorie_deficit | 状态 = 完成 | 热量缺口计算 | "今天你创造了五百大卡的热量缺口。如果饮食配合，这相当于每周减重零点五公斤的进度。" |
| 20 | fatburn_20_metabolic_fire | 状态 = 完成 | 最后的记忆锚定 | "记住今天高效燃脂的感觉。这种'代谢火力'会随着每次跑步越来越强。" |

---

## 真实场景触发示例

### 场景 1：新手第一次跑 3km

```
开始跑步
  ↓ (0m)
"我们轻轻开始，像饭后散步一样..." (开场)
  ↓ (100m)
"注意感受脚掌落地再弹起的感觉..." (身体感知)
  ↓ (500m)
"五百米了！身体开始热起来了..." (第一个小里程碑)
  ↓ (1km)
"一公里！第一个里程碑..." (重要里程碑)
  ↓ (心率升高到 165)
"如果感觉呼吸急促，很正常..." (心率预警)
  ↓ (用户开始走路)
"走的时候也别停，保持脚步移动..." (行走指导)
  ↓ (1.5km)
"一点五公里，已经过半了..." (过半鼓励)
  ↓ (2km, 跑了 20 分钟，开始疲劳)
"感到累了？这是身体在说'我正在变强'..." (疲劳重构)
  ↓ (2.5km)
"最后五百米！..." (冲刺开始)
  ↓ (3km)
"三…二…一…完成！三公里达成！" (完成)
  ↓ (点击停止)
"慢慢停下，不要立刻静止..." (完成后指导)
"恭喜！你刚刚完成了人生第一个三公里..." (庆祝)
"看看你的数据：三公里..." (数据回顾)
```

### 场景 2：减肥模式燃脂跑

```
开始跑步
  ↓ (0m)
"燃脂模式启动！今天的目标：让脂肪高效燃烧..." (开场)
  ↓ (200m)
"减肥的关键不是跑多快，而是让身体进入'燃脂区间'..." (教育)
  ↓ (燃烧 100 大卡)
"一百大卡达成！相当于一个苹果派..." (热量里程碑)
  ↓ (心率进入最佳区间)
"完美！心率正处在最佳燃脂区间..." (心率反馈)
  ↓ (燃烧 200 大卡)
"二百大卡！这需要普通人散步五十分钟..." (热量里程碑)
  ↓ (15 分钟)
"你已经连续运动十五分钟，新陈代谢率正在提升..." (时间里程碑)
  ↓ (燃烧 300 大卡)
"三百大卡里程碑！..." (热量里程碑)
  ↓ (感到疲劳)
"感到辛苦时，想象脂肪细胞正在缩小..." (视觉化激励)
  ↓ (完成)
"跑步结束！但燃脂还在继续..." (完成总结)
```

---

## 触发优先级规则

1. **state（状态）触发** 优先级最高（开始、完成等关键时刻）
2. **distance（距离）触发** 第二优先（里程碑）
3. **calories（热量）触发** 第三优先（减肥模式重点）
4. **heartRate（心率）触发** 安全预警优先
5. **fatigue（疲劳）触发** 心理支持
6. **time（时长）触发** 背景监控

## 防重复播放机制

- 每条语音只播放一次（playedScripts 集合记录）
- 重新开始跑步时，playedScripts 自动清空
- 按 order 排序，优先触发序号小的

---

**更新时间**: 2026-02-01
**总计**: 50 条语音（新手 30 + 减肥 20）
**音色**: 新手 cherry（女声）、减肥 ethan（男声）
